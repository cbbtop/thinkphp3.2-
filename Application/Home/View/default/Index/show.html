<!-- 
wikins开源博客
基于thinkphp3.2框架开发
wilinks 版权所有
博客地址：www.cbbtop.com
 -->
<include file="Common/contact"/>
<style type="text/css">
  .page>div>a, .page>div>span {
    position: relative;
    padding: 6px 12px;
    margin-left: -1px;
    line-height: 1.42857143;
    color: #848399;
    text-decoration: none;
    background-color: #fff;
    border: 1px solid #ddd;
    top:27px;
  }
  .page>div>span {
    background-color: #f2efef;
  }
</style>
<include file="Common/header"/>
<article class="main-content page-page" itemscope itemtype="">
  <div class="post-header">
    <h1 class="post-title" itemprop="name headline">{$show[0]['title']}</h1>
    <div class="post-data">
      <time datetime="2017-08-23T07:14:00+08:00" itemprop="datePublished">Published on {$show[0][created_at]}</time>
      <!--<a href="https://www.linpx.com/c/tutorials/"></a>-->
      <a href="#comments"> 评论 <if condition="$count != ''">{$count}<else />0 </if></a>
      <a href="#zans"> 点赞 <if condition="$zans != ''">{$zans}<else />0</if></a>
      <a href="#zans"> 人气 <if condition="looks_count != ''">{$looks_count}<else />0</if></a>
      </div>
  </div>
  <div id="post-content" class="post-content" itemprop="articleBody">
    <p class="post-tags">
      <foreach name="tags" item="vo">
      <a href="{:U('Index/tag',array('id'=>$vo['id']))}">{$vo.tag}</a>
      </foreach>
    </p>
    {$show[0]['content']}
    <p class="post-info">本文由
      <a href="https://www.linpx.com/author/1/">wilkins</a>创作
      <br>本站文章除注明转载/出处外，均为本站原创或翻译，转载前请务必署名
      <br>最后编辑时间为: {$show[0]['updated_at']}
    </p>
    <br><font color="orange">*喜欢本文章觉得有帮助的话，扫个打赏码，给博主打赏个买菜钱$</font>
  </div>
  <div><img height="50%" src="__PICTURE__/wx-code.jpg" alt=""></div>
  <br>
      <button onclick="dzans();" type="button" id="zans" class="btn btn-primary"><if condition="$zan_type != ''">取消赞<else />点赞</if></button>
</article>
<div id="post-bottom-bar" class="post-bottom-bar">
  <div class="bottom-bar-inner">
    <div class="bottom-bar-items social-share left">
      <span class="bottom-bar-item">Share :</span>
      <span class="bottom-bar-item bottom-bar-facebook">
            <a href="https://github.com/cbbtop" target="_blank" title="" rel="nofollow">github</a></span>
    </div>

    <div class="bottom-bar-items right">
      <span class="bottom-bar-item"></span>
      <!--<span class="bottom-bar-item">-->
            <!--<a href="{:U('Index/tag')}" title="">→</a></span>-->
      <span class="bottom-bar-item">
            <a href="#footer">↓</a></span>
      <span class="bottom-bar-item">
            <a href="#">↑</a></span>
    </div>
  </div>
</div>
<div id="respond-post-301" class="comment-container">
  <div id="comments" class="clearfix">
        <span class="response">留言板:
    <form method="post" action="{:U('Index/addcomments')}" id="comment-form" class="comment-form" role="form">
      <input type="text" name="author" maxlength="12" id="author" class="form-control input-control clearfix" placeholder="Name (*)" value="" required>
      <textarea name="text" id="textarea" class="form-control" placeholder="打算说点啥??" required></textarea>
      <button type="submit" class="submit" id="misubmit">留言</button>
      <input type="hidden" name="id" value="{$_GET['id']}"></form>
    <ol class="comment-list">

      <foreach name="comments" item="vo">
      <li class="comment-body comment-parent comment-odd">
        <div>
          <div class="comment-view" onclick="">
            <div class="comment-header">
              <img class="avatar" src="__IMAGES__/user/tx<?php echo rand(1,10);?>.gif" width="80" height="80">
              <span class="comment-author"><if condition="$vo['user_id'] != ''">{$vo['user_id']}<else />{$vo['name']}</if></span></div>
            <div class="comment-content">
              <span class="comment-author-at"></span>
              <p>{$vo['content']}</p>
              <p>
              </p>
            </div>
            <div class="comment-meta">
              <time class="comment-time">{$vo['created_at']}</time>
              <span class="comment-reply">
            <a href="" rel="nofollow" onclick="return alert('还不行啊，回复个x啊')">回复</a></span>
            </div>
          </div>
        </div>
        <!--回复-->
        <if condition="$vo['for_content'] neq ''">
        <div class="comment-children">
            <ol class="comment-list">
              <li id="li-comment-1238" class="comment-body comment-child comment-level-odd comment-odd">
                <div id="comment-1238">
                  <div class="comment-view">
                    <div class="comment-header">
                      <img class="avatar" src="http://q.qlogo.cn/qqapp/101429322/4EABB2D7D23DEC3FCD6BD6C10F78F5DC/40" width="80" height="80">
                      <span class="comment-author comment-by-author">CBBTOP</span>
                    </div>
                    <div class="comment-content">
                      <span style="color: red"  class="comment-author-at">
                        @{$vo['name']}</span>
                      <p>{$vo['for_content']}</p>
                        <p></p>
                    </div>
                    <div class="comment-meta">
                      <time class="comment-time">{$vo['fortime']}</time>
                      <span class="comment-reply">
                        <a href="" rel="nofollow" onclick="return alert('还不行啊，回复个x啊')">回复</a></span>
                    </div>
                  </div>
                </div>
              </li>
            </ol>
        </div>
        <else /></if>
      </li>
      </foreach>
    </ol>
    <div class="page page-navigator" align="center">{$page}</div>
    <br>
    <br>
  </div>
</div>
<include file="Common/footer"/>

<div id="directory-content" class="directory-content">
  <div id="directory"></div>
</div>
<script src="__JS__/jquery/jquery.min.js"></script>
<script>

  function dzans() {

      $.post("{:U('Home/Index/addzans')}",{post_id:{$show[0]['id']}},function(re){
          if(re.code == 404){

          }else {
              $("#zans").html(re.code);
          }
      });
  }


    var postDirectoryBuild = function() {
    var postChildren = function children(childNodes, reg) {
            var result = [],
                isReg = typeof reg === 'object',
                isStr = typeof reg === 'string',
                node,
                i,
                len;
            for (i = 0, len = childNodes.length; i < len; i++) {
                node = childNodes[i];
                if ((node.nodeType === 1 || node.nodeType === 9) && (!reg || isReg && reg.test(node.tagName.toLowerCase()) || isStr && node.tagName.toLowerCase() === reg)) {
                    result.push(node);
                }
            }
            return result;
        },
        createPostDirectory = function(article, directory, isDirNum) {
            var contentArr = [],
                titleId = [],
                levelArr,
                root,
                level,
                currentList,
                list,
                li,
                link,
                i,
                len;
            levelArr = (function(article, contentArr, titleId) {
                var titleElem = postChildren(article.childNodes, /^h\d$/),
                    levelArr = [],
                    lastNum = 1,
                    lastRevNum = 1,
                    count = 0,
                    guid = 1,
                    id = 'directory' + (Math.random() + '').replace(/\D/, ''),
                    lastRevNum,
                    num,
                    elem;
                while (titleElem.length) {
                    elem = titleElem.shift();
                    contentArr.push(elem.innerHTML);
                    num = +elem.tagName.match(/\d/)[0];
                    if (num > lastNum) {
                        levelArr.push(1);
                        lastRevNum += 1;
                    } else if (num === lastRevNum || num > lastRevNum && num <= lastNum) {
                        levelArr.push(0);
                        lastRevNum = lastRevNum;
                    } else if (num < lastRevNum) {
                        levelArr.push(num - lastRevNum);
                        lastRevNum = num;
                    }
                    count += levelArr[levelArr.length - 1];
                    lastNum = num;
                    elem.id = elem.id || (id + guid++);
                    titleId.push(elem.id);
                }
                if (count !== 0 && levelArr[0] === 1) levelArr[0] = 0;
                return levelArr;
            })(article, contentArr, titleId);
            currentList = root = document.createElement('ul');
            dirNum = [0];
            for (i = 0, len = levelArr.length; i < len; i++) {
                level = levelArr[i];
                if (level === 1) {
                    list = document.createElement('ul');
                    if (!currentList.lastElementChild) {
                        currentList.appendChild(document.createElement('li'));
                    }
                    currentList.lastElementChild.appendChild(list);
                    currentList = list;
                    dirNum.push(0);
                } else if (level < 0) {
                    level *= 2;
                    while (level++) {
                        if (level % 2) dirNum.pop();
                        currentList = currentList.parentNode;
                    }
                }
                dirNum[dirNum.length - 1]++;
                li = document.createElement('li');
                link = document.createElement('a');
                link.href = '#' + titleId[i];
                link.innerHTML = !isDirNum ? contentArr[i] : dirNum.join('.') + ' ' + contentArr[i];
                li.appendChild(link);
                currentList.appendChild(li);
            }
            directory.appendChild(root);
        };
    createPostDirectory(document.getElementById('post-content'), document.getElementById('directory'), true);
};
postDirectoryBuild();</script>
<script>(function() {
    window.TypechoComment = {
        dom: function(id) {
            return document.getElementById(id);
        },
        create: function(tag, attr) {
            var el = document.createElement(tag);
            for (var key in attr) {
                el.setAttribute(key, attr[key]);
            }
            return el;
        },
        reply: function(cid, coid) {
            var comment = this.dom(cid),
                parent = comment.parentNode,
                response = this.dom('respond-post-301'),
                input = this.dom('comment-parent'),
                form = 'form' == response.tagName ? response: response.getElementsByTagName('form')[0],
                textarea = response.getElementsByTagName('textarea')[0];
            if (null == input) {
                input = this.create('input', {
                    'type': 'hidden',
                    'name': 'parent',
                    'id': 'comment-parent'
                });
                form.appendChild(input);
            }
            input.setAttribute('value', coid);
            if (null == this.dom('comment-form-place-holder')) {
                var holder = this.create('div', {
                    'id': 'comment-form-place-holder'
                });
                response.parentNode.insertBefore(holder, response);
            }
            comment.appendChild(response);
            this.dom('cancel-comment-reply-link').style.display = '';
            if (null != textarea && 'text' == textarea.name) {
                textarea.focus();
            }
            return false;
        },
        cancelReply: function() {
            var response = this.dom('respond-post-301'),
                holder = this.dom('comment-form-place-holder'),
                input = this.dom('comment-parent');
            if (null != input) {
                input.parentNode.removeChild(input);
            }
            if (null == holder) {
                return true;
            }
            this.dom('cancel-comment-reply-link').style.display = 'none';
            holder.parentNode.insertBefore(response, holder);
            return false;
        }
    };
})();
function getCommentCookie(name) {
    var arr, reg = new RegExp("(^| )" + name + "=([^;]*)(;|$)");
    if (arr = document.cookie.match(reg)) return unescape(decodeURI(arr[2]));
    else return null;
}
function addCommentInputValue() {
    document.getElementById('author').value = getCommentCookie('6ee012733224975cc25c285033ecb4a3__typecho_remember_author');
    document.getElementById('mail').value = getCommentCookie('6ee012733224975cc25c285033ecb4a3__typecho_remember_mail');
    document.getElementById('url').value = getCommentCookie('6ee012733224975cc25c285033ecb4a3__typecho_remember_url');
}
addCommentInputValue();</script>
<script src="__JS__/headroom.min.js"></script>
<script>
    var postDirectory = new Headroom(document.getElementById("directory-content"), {
    tolerance: 0,
    offset: 0,
    classes: {
        initial: "initial",
        pinned: "pinned",
        unpinned: "unpinned"
    }
});
postDirectory.init();
var postSharer = new Headroom(document.getElementById("post-bottom-bar"), {
    tolerance: 0,
    offset: 0,
    classes: {
        initial: "animated",
        pinned: "pinned",
        unpinned: "unpinned"
    }
});
postSharer.init();
var header = new Headroom(document.getElementById("header"), {
    tolerance: 0,
    offset: 0,
    classes: {
        initial: "animated",
        pinned: "slideDown",
        unpinned: "slideUp"
    }
});
header.init();
</script>
</body>

</html>